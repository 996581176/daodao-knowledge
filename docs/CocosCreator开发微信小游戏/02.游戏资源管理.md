---
title: 游戏资源管理
date: 2024-04-26 15:42:53
permalink: /pages/870050/
categories:
  - CocosCreator开发微信小游戏
tags:
    -
---
从本质上说，每个游戏都是由种类繁多，数量庞大的资源构成的，因此，管理包括图片，声音，字体，粒子，地图等多媒体资源是一款游戏引擎的核心功能。  
资源管理的知识主要有几个方面：包括对于资源的组织，运行期对于资源的载入、清理及对于资源的操作以及资源的优化。  

## 图片资源的管理
图片资源又称贴图，是游戏中，尤其是2D游戏中绝大部分对象的渲染源，图片资源一般由软件制作而成并输出称游戏引擎支持的格式，目前支持的格式包括JPG和PNG两种，除了单张图片外，Cocos Creator还支持图集资源的导入和自动图集资源的生成功能。  

### 图片资源的导入
图片资源导入的方式非常简单，就是将图片资源复制到资源管理器所在的目录下，在资源管理器中的对应目录下就可以看到相应的图片资源，在对于的资源管理器中会显示自身图片的缩略图，以方便你找到想选的那个图片，单击三角形按钮就可以打开图片的子资源，也就是说单机开三角形后可以看到同名的SpriteFramem,SpriteFrame是精灵类用来显示图像的对象。  
对于图片集资源来说，可以有多个图片资源在一个资源名下，直接将SpriteFrame或者图像资源从资源管理器中拖拽到场景编辑器，或者属性监视器的对应属性下时，就可以设置节点的图片显示。单击对应的图片资源文件或者SpriteFrame就可以看到对应的属性检查器中可以编辑的属性，但是目前这些属性的编辑暂时无法影响图片资源在游戏中使用时的属性，应该是为未来引擎扩展预留的编辑接口。
![](https://daodaoblogpicgo.oss-cn-shanghai.aliyuncs.com/img/2024042601.gif)  
运行起来是这样的  
![](https://daodaoblogpicgo.oss-cn-shanghai.aliyuncs.com/img/202404261602188.png)

### 图集资源的制作和导入
图集，也称作 Sprite Sheet, 是游戏开发中场景的一种美术资源。图集是通过专门的工具将多张图片合并成一张大图，并通过plist等格式的文件索引的资源。可供Cocos Creator使用的图集资源由plist和png文件组成。下面就是一张图集使用的图片文件：
![](https://daodaoblogpicgo.oss-cn-shanghai.aliyuncs.com/img/202404261616330.png)

::: warning 为什么要使用图集资源
在游戏中使用多张图片合成的图集作为美术资源，有以下优势：  
- 合成图集时会去除每张图片周围的空白区域，加上可以在整体上实施各种优化算法，合成图集后可以大大减少游戏包体和内存占用 
- 多个Sprite如果渲染是来自同一张图集的图片时，这些Sprite可以使用同一个渲染批次来处理，大大减少CPU的运算时间，提高运行效率。

更形象生动的解释可以观看来自CodeAndWeb的教学视频 What is a Sprite Sheet，需要使用VPN打开视频。
:::

## 声音资源的管理
游戏不止是简单的界面和动画，还需要音乐音效配合。在很多经典的游戏中，音乐音效不止是配角，还可以起到控制游戏节奏、向玩家提示游戏场景的作用。例如有些过关游戏中，在进入Boss关时，音乐变化以此来提示玩家本关的不同之处，另外还有一些游戏，就是以音乐节奏来配合出怪的频率节奏等，这样玩家可以完全融入到游戏中。

### WebAudio方式加载音频
再Cocos Creator中加载音频的方式和图片一样，在资源管理器的路径下添加音频文件即可

Web 平台上的音频资源比较特别，因为 Web 标准支持以两种不同的方式加载音频资源，分别是：

Web Audio：提供相对更加现代化的声音控制接口，在引擎内是以一个 audio buffer 的形式缓存的。这种方式的优点是兼容性好，问题比较少。
DOM Audio：通过生成一个标准的 audio 元素来播放音频资源，在引擎内缓存的就是这个 audio 元素。使用标准的 audio 元素播放音频资源时，在某些浏览器上可能会遇到一些兼容性问题，比如 iOS 上的浏览器不支持调整音量大小，所有 volume 相关属性将不会生效。
目前 Cocos Creator 默认以 Web Audio 的方式加载音频资源，但如果检测到当前浏览器不支持加载 Web Audio，则会切换使用 DOM Audio 的方式加载音频。

## 预制体的创建和使用
预制体这个概念是引自Unity引擎的，它是一种可以被重复使用的游戏对象。例如射击游戏中的子弹都来自于同一个子弹模型，当发射子弹时，就创建一个子弹预制体。也就是说，如果创建一个可以重复使用的对象，那么就该用预制体了。

### 什么是预制体
在一般的游戏开发中，并没有预制体这个概念，它曾经是Unity的专用术语，它可以简单解释成“用于创建大量相同的物件而使用的模板”，也就是说它可以被用于创建重复的对象。虽说它是从Unity才有的概念，但是预制体的设计思想类似设计模式中的原型模式，是用于创建重复的对象，同时又能保证性能。这种类型的设计模式属于创建型模式，它提供了一种创建对象的最佳方式。当直接创建对象的代价比较大时，则采用这种模式。Cocos Creator中的预制体的用法和Unity类似，当制作好了游戏组件，也就是场景中的任意一个对象时，我们可以将它制作成一个组件模板，用于批量的套用工作。例如，场景中本质上要重复使用的东西，像敌人、士兵、子弹或者一个砖块完全相同的墙体。

### 创建预制体
- 在场景中将节点编辑好之后，直接将节点从 层级管理器 拖到 资源管理器 中即可完成预制件资源的创建。

- 点击 资源管理器 左上方的 + 按钮，或者点击面板空白处，然后选择 Node Prefab 即可。（v3.1.1 新增）

## 字体资源的管理
在游戏中，文字占有很重要的位置，尤其对于现在卡牌游戏盛行的市场，界面开发占游戏开发很大的篇幅，其中游戏的介绍，游戏中的提示和对话等都需要用到文字，Cocos Creator在文字渲染方面提供了非常灵活的机制，既可以直接使用系统字，也可以自渲染字体。使用Cocos Creator制作游戏可以使用三类字体资源：系统字体，动态字体和位图字体。

### 系统字体
其中系统字体是通过调用游戏运行平台自带的系统字体来渲染文字，不需要用户在项目中添加任何相关资源。要使用系统字体，请使用 Label组件 中的 Use System Font 属性。

### 动态字体
目前 Cocos Creator 支持 TTF 格式的动态字体。只要将扩展名为 TTF 的字体文件拖拽到 资源管理器 中，即可完成字体资源的导入。